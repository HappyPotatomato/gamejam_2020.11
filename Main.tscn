[gd_scene load_steps=9 format=2]

[ext_resource path="res://Maps/DebugMap.tscn" type="PackedScene" id=1]
[ext_resource path="res://Characters/Player.tscn" type="PackedScene" id=2]
[ext_resource path="res://Map Components/Box.tscn" type="PackedScene" id=3]
[ext_resource path="res://Button/Button.tscn" type="PackedScene" id=4]
[ext_resource path="res://Main.gd" type="Script" id=5]

[sub_resource type="GDScript" id=1]
script/source = "#Player.gc
extends KinematicBody2D

#Variáveis exportáveis
#Stats
export var active = false
export var strength = 500
export var camlimits = {\"Left\":-10000000,\"Top\":-10000000,\"Right\":10000000,\"Bottom\":10000000}

#Respawn Data
export(String,FILE,\"*.tscn\") var spawn_scene_path
export var spawn_coordinates = Vector2()

#Variáveis
var player_input = {}

#Nodes
onready var controller 	= get_node(\"Controller\")
onready var camera 		= get_node(\"Camera2D\")

func _ready():
	camera.limit_left = camlimits.Left
	camera.limit_top = camlimits.Top
	camera.limit_right = camlimits.Right
	camera.limit_bottom = camlimits.Bottom

func _process(delta):
	#Muda o current da camera de acordo com a var active
	#Ou seja, quando o active é true a câmera desse personagem é usada quando o active é false a camera desse personagem não é usada
	if camera.current != active:
		camera.current = active
	if controller.input_enabled != active:
		controller.input_enabled = active
	
	#Player controls. Teclas podem ser encontradas em Project>>Project Settings>>Input Map
	player_input.right = Input.is_action_pressed(\"Right\")
	player_input.left = Input.is_action_pressed(\"Left\")
	player_input.jump = Input.is_action_pressed(\"Jump\")
	
	#Look at deez moves moving
	controller.move(player_input.right,player_input.left,player_input.jump)
	
	#Detecta colisões com corpos
	for i in get_slide_count():
		var collision = get_slide_collision(i)
		var body = collision.collider
		
		#Detecta se o objeto que colidiu pode ser movido
		if body.is_in_group(\"MovableObjects\"):
			
			#Use a força!
			var force_dir = Vector2(body.global_position - self.global_position).normalized()
			body.apply_central_impulse(force_dir * strength)
			
"

[sub_resource type="GDScript" id=2]
script/source = "#Player.gc
extends KinematicBody2D

#Variáveis exportáveis
#Stats
export var active = false
export var strength = 500
export var camlimits = {\"Left\":-10000000,\"Top\":-10000000,\"Right\":10000000,\"Bottom\":10000000}

#Respawn Data
export(String,FILE,\"*.tscn\") var spawn_scene_path
export var spawn_coordinates = Vector2()

#Variáveis
var player_input = {}

#Nodes
onready var controller 	= get_node(\"Controller\")
onready var camera 		= get_node(\"Camera2D\")

func _ready():
	camera.limit_left = camlimits.Left
	camera.limit_top = camlimits.Top
	camera.limit_right = camlimits.Right
	camera.limit_bottom = camlimits.Bottom

func _process(delta):
	#Muda o current da camera de acordo com a var active
	#Ou seja, quando o active é true a câmera desse personagem é usada quando o active é false a camera desse personagem não é usada
	if camera.current != active:
		camera.current = active
	if controller.input_enabled != active:
		controller.input_enabled = active
	
	#Player controls. Teclas podem ser encontradas em Project>>Project Settings>>Input Map
	player_input.right = Input.is_action_pressed(\"Right\")
	player_input.left = Input.is_action_pressed(\"Left\")
	player_input.jump = Input.is_action_pressed(\"Jump\")
	
	#Look at deez moves moving
	controller.move(player_input.right,player_input.left,player_input.jump)
	
	#Detecta colisões com corpos
	for i in get_slide_count():
		var collision = get_slide_collision(i)
		var body = collision.collider
		
		#Detecta se o objeto que colidiu pode ser movido
		if body.is_in_group(\"MovableObjects\"):
			
			#Use a força!
			var force_dir = Vector2(body.global_position - self.global_position).normalized()
			body.apply_central_impulse(force_dir * strength)
			
"

[sub_resource type="GDScript" id=3]
script/source = "#Box
extends RigidBody2D

func _ready():
	pass
"

[node name="Main" type="Node"]
script = ExtResource( 5 )

[node name="DebugMap" parent="." instance=ExtResource( 1 )]

[node name="Yamada" parent="." instance=ExtResource( 2 )]
position = Vector2( 1664, 3200 )
script = SubResource( 1 )
camlimits = {
"Bottom": 3856,
"Left": -10000000,
"Right": 10000000,
"Top": 0
}

[node name="Button" parent="." instance=ExtResource( 4 )]
position = Vector2( 5888, 7936 )

[node name="Su" parent="." instance=ExtResource( 2 )]
position = Vector2( 1664, 7808 )
script = SubResource( 2 )
camlimits = {
"Bottom": 6120,
"Left": -10000000,
"Right": 10000000,
"Top": 4880
}

[node name="BoxLight" parent="." instance=ExtResource( 3 )]
position = Vector2( 8960, 7808 )

[node name="BoxHeavy" parent="." instance=ExtResource( 3 )]
position = Vector2( 0, 768 )
mass = 20.0
script = SubResource( 3 )
